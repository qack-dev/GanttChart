# ガントチャートプロジェクト管理ツール

## 概要

本プロジェクトは、Microsoft Excel VBA を用いて開発された、シンプルながらも実用的なガントチャートプロジェクト管理ツールです。タスクの進捗状況を視覚的に把握し、プロジェクト管理を効率化することを目的としています。Visual Studio Code (VS Code) と XVBA 拡張機能を用いた開発スタイルを採用しており、コードの可読性、保守性、拡張性を重視しています。

## 機能

*   **タスクデータ入力**: 「Tasks」シートにタスク名、期間、開始日、進捗率、ステータスなどを入力できます。
*   **ガントチャート自動生成**: データ入力後、または専用ボタンクリックで、「GanttChart」シートにガントチャートが自動的に描画・更新されます。
*   **ステータスに応じた色分け**: タスクのステータス（未着手、進行中、完了、遅延）に応じて、ガントチャートのバーの色が自動的に変更されます。
*   **全体進捗グラフ**: プロジェクト全体の進捗状況を視覚的に示すグラフが表示されます。
*   **タスク詳細ポップアップ**: ガントチャート上のタスクバーをクリックすると、そのタスクの詳細情報（タスク名、期間、進捗など）がメッセージボックスで表示されます。

## 開発環境

*   **開発ツール**: Visual Studio Code (VS Code)
*   **VBA開発拡張機能**: XVBA
*   **言語**: VBA (Visual Basic for Applications)

## プロジェクト構造

### Excel シート構成

本ツールは以下の3つの主要なシートで構成されます。

1.  **Tasks シート**
    *   タスクデータを入力するためのシートです。
    *   **列構成**:
        *   A列: `ID` (自動採番)
        *   B列: `タスク名`
        *   C列: `期間` (日数)
        *   D列: `開始日` (日付形式)
        *   E列: `終了日` (日付形式、`=[開始日]+[期間]-1` で自動計算)
        *   F列: `進捗` (パーセンテージ)
        *   G列: `ステータス` (ドロップダウンリスト: 未着手, 進行中, 完了, 遅延)

2.  **GanttChart シート**
    *   ガントチャートと全体進捗グラフが描画されるシートです。

3.  **Settings シート**
    *   アプリケーションの基本設定（ステータスごとの色設定、ガントチャートの描画開始位置など）を管理するシートです。
    *   **設定例**:
        *   ステータスごとのRGBカラー値
        *   ガントチャートの描画開始行・列

### VBA モジュール構成

VBAコードは、機能ごとに以下のモジュールに分割されています。

*   **M_GanttChart (標準モジュール)**
    *   ガントチャートの描画、更新、全体進捗グラフの更新など、主要なロジックを格納します。
    *   `Public Sub UpdateGanttChart()`: メインの更新プロシージャ。
    *   `Private Sub DrawTaskBar(taskData As Object)`: 個々のタスクバーを描画。
    *   `Private Sub DrawTimeline(startDate As Date, endDate As Date)`: タイムラインを描画。
    *   `Private Sub UpdateLoadGraph()`: 全体進捗グラフを更新。

*   **M_ChartEvents (標準モジュール)**
    *   ガントチャート上のタスクバー（Shapeオブジェクト）クリックイベントを処理します。
    *   `Public Sub ShowTaskDetails()`: クリックされたタスクの詳細を表示。

*   **C_Task (クラスモジュール)**
    *   タスクデータをオブジェクトとして扱うためのクラスです。（任意）

*   **Sheet_Tasks (シートモジュール)**
    *   「Tasks」シートのイベント（例: `Worksheet_Change`）を処理し、データ変更時にガントチャートの更新をトリガーします。

*   **Sheet_GanttChart (シートモジュール)**
    *   「GanttChart」シートに配置されたボタンのアクションなどを記述します。

## 使用方法

### セットアップ

1.  **Excelファイルの作成**:
    *   新しいExcelファイルを作成し、`.xlsm`形式で保存します（例: `GanttChart.xlsm`）。
    *   以下の3つのシートを作成し、それぞれ「Tasks」、「GanttChart」、「Settings」と名前を変更します。
2.  **シートの初期設定**:
    *   **Tasks シート**: A1セルから「ID」「タスク名」「期間」「開始日」「終了日」「進捗」「ステータス」と入力します。
    *   **Settings シート**: ステータスごとの色設定（例: 未着手: RGB(255, 255, 0) など）や、ガントチャートの描画開始位置（例: 開始行: 5, 開始列: 3）などを入力します。
3.  **VBAコードのインポート**:
    *   VBAエディタ（Alt + F11）を開き、プロジェクトエクスプローラーで「GanttChart.xlsm」プロジェクトを展開します。
    *   「標準モジュール」に`M_GanttChart`と`M_ChartEvents`を、「クラスモジュール」に`C_Task`を（もし作成した場合）、「Microsoft Excel Objects」の各シートオブジェクトに`Sheet_Tasks`と`Sheet_GanttChart`のコードをインポートまたは貼り付けます。
    *   XVBAを使用している場合は、`vba-files`ディレクトリ内の`.bas`および`.cls`ファイルをプロジェクトに同期させます。
4.  **「チャート更新」ボタンの配置**:
    *   「GanttChart」シートに「開発」タブから「挿入」→「フォームコントロール」または「ActiveXコントロール」のボタンを配置します。
    *   ボタンを右クリックし、「マクロの登録」から`M_GanttChart.UpdateGanttChart`を登録します。

### ツール利用手順

1.  **タスクデータの入力**:
    *   「Tasks」シートのB列以降に、タスク名、期間、開始日、進捗、ステータスを入力します。
    *   「終了日」は自動計算されます。
2.  **ガントチャートの更新**:
    *   「GanttChart」シートに移動し、「チャート更新」ボタンをクリックします。
    *   「Tasks」シートのデータが変更されると、自動的にガントチャートが更新されます。
3.  **タスク詳細の確認**:
    *   「GanttChart」シートに描画されたタスクバーをクリックすると、そのタスクの詳細情報がメッセージボックスで表示されます。

## コード品質と規約

*   **コメント**: 各プロシージャや複雑なロジックには、詳細なコメントを付与し、コードの意図を明確にします。
*   **命名規則**: 変数名、プロシージャ名、モジュール名は、その役割が明確にわかるように命名します（例: `taskRow`, `DrawGanttChart`）。
*   **エラーハンドリング**: 予期せぬエラーが発生した場合に備え、`On Error GoTo` などのエラーハンドリングを適切に実装します。
*   **モジュール化**: 機能ごとにモジュールを分割し、コードの保守性と再利用性を高めます。

## 補足

本プロジェクトは、Gemini CLI と XVBA の連携を想定して開発されています。XVBA を使用することで、Excel のマクロが無効になっていても、Excel シートの編集が可能になります。詳細については、[Gemini CLI + MCP で Excel を操作する](https://zenn.dev/acntechjp/articles/77a521ec0ac654) をご参照ください。
